<!DOCTYPE html><html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Ù…ÙˆÙ„Ù‘Ø¯ ÙˆÙØ§Ø­Øµ Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„ØªØ±Ø®ÙŠØµ</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to right, #e0f7fa, #fce4ec);
      color: #333;
      padding: 30px;
      direction: rtl;
    }
    h2 {
      color: #00695c;
      margin-top: 40px;
    }
    label {
      display: block;
      margin: 10px 0 5px;
      font-weight: bold;
    }
    input, textarea, button {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border-radius: 8px;
      border: 1px solid #ccc;
      box-sizing: border-box;
      font-size: 16px;
    }
    button {
      background: #00796b;
      color: white;
      border: none;
      transition: background 0.3s;
    }
    button:hover {
      background: #004d40;
    }
    .output {
      background: #f1f8e9;
      padding: 15px;
      border-radius: 8px;
      border: 1px dashed #8bc34a;
      white-space: pre-wrap;
      word-break: break-word;
    }
    hr {
      border: none;
      border-top: 2px dashed #ccc;
      margin: 40px 0;
    }
  </style>
</head>
<body>
  <h2>ğŸ” ØªÙˆÙ„ÙŠØ¯ ÙƒÙˆØ¯ Ù…Ø´ÙØ± Ù…Ø¹ ÙˆÙ‚Øª Ù…Ø®ØµØµ</h2><label>ğŸ”‘ ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„</label> <input type="text" id="codeInput" placeholder="Ù…Ø«Ø§Ù„: 42FA-E2A9-..." />

<label>ğŸ•’ ÙˆÙ‚Øª Ø§Ù„Ø¨Ø¯Ø¡</label> <input type="datetime-local" id="startDateTime" />

<label>ğŸ•“ ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</label> <input type="datetime-local" id="endDateTime" />

<button onclick="generateCode()">âœ¨ ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø´ÙØ±</button>

<label>ğŸ“¦ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø´ÙØ±</label>

  <textarea class="output" id="encodedOutput" rows="4" readonly></textarea>  <hr>  <h2>ğŸ§© ØªØ­Ù„ÙŠÙ„ ÙƒÙˆØ¯ Ù…Ø´ÙØ±</h2><label>ğŸ“¥ Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø´ÙØ±</label>

  <textarea id="decodeInput" placeholder="Ø£Ù„ØµÙ‚ Ø§Ù„ÙƒÙˆØ¯ Ù‡Ù†Ø§..." rows="4"></textarea><button onclick="decodeCode()">ğŸ” ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯</button>

  <div class="output" id="decodedDetails"></div>  <script>
    function generateCode() {
      const code = document.getElementById('codeInput').value.trim();
      const startInput = document.getElementById('startDateTime').value;
      const endInput = document.getElementById('endDateTime').value;

      if (!code || !startInput || !endInput) {
        alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ÙƒÙˆØ¯ ÙˆØªØ­Ø¯ÙŠØ¯ ÙˆÙ‚ØªÙŠ Ø§Ù„Ø¨Ø¯Ø¡ ÙˆØ§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡!');
        return;
      }

      const startDate = new Date(startInput);
      const endDate = new Date(endInput);

      if (endDate <= startDate) {
        alert('ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨Ø¹Ø¯ ÙˆÙ‚Øª Ø§Ù„Ø¨Ø¯Ø¡!');
        return;
      }

      const durationMs = endDate - startDate;
      const durationDays = +(durationMs / (1000 * 60 * 60 * 24)).toFixed(5);

      const payload = {
        ActivationCode: code,
        StartDate: startDate.toISOString(),
        EndDate: endDate.toISOString(),
        validDays: durationDays,
        Item_id: Math.floor(Math.random() * 90000000) + 10000000,
        purchasecode: generateRandomToken(64)
      };

      const jsonStr = JSON.stringify(payload);
      const base64 = btoa(unescape(encodeURIComponent(jsonStr)));
      document.getElementById('encodedOutput').value = base64;
    }

    function decodeCode() {
      const input = document.getElementById('decodeInput').value.trim();
      const output = document.getElementById('decodedDetails');
      try {
        const jsonStr = decodeURIComponent(escape(atob(input)));
        const obj = JSON.parse(jsonStr);
        const start = new Date(obj.StartDate);
        const end = new Date(obj.EndDate);
        const diffMs = end - start;
        const days = Math.floor(diffMs / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diffMs % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60));

        output.innerText =
          `ğŸ”‘ ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„: ${obj.ActivationCode}\n` +
          `ğŸ“… ÙˆÙ‚Øª Ø§Ù„Ø¨Ø¯Ø¡: ${start.toLocaleString()}\n` +
          `ğŸ“… ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡: ${end.toLocaleString()}\n` +
          `â³ Ù…Ø¯Ø© Ø§Ù„ÙƒÙˆØ¯: ${days} ÙŠÙˆÙ…ØŒ ${hours} Ø³Ø§Ø¹Ø©ØŒ ${minutes} Ø¯Ù‚ÙŠÙ‚Ø©\n` +
          `ğŸ§¾ Ø±Ù‚Ù… Ø§Ù„Ø¹Ù†ØµØ±: ${obj.Item_id}\n` +
          `ğŸ” Ø±Ù…Ø² Ø§Ù„Ø´Ø±Ø§Ø¡: ${obj.purchasecode}`;
      } catch (e) {
        output.innerText = 'âš ï¸ Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ§Ù„Ø­ Ø£Ùˆ ØºÙŠØ± Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ­Ù„ÙŠÙ„.';
      }
    }

    function generateRandomToken(length) {
      const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
      let result = "";
      for (let i = 0; i < length; i++) {
        result += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      return result;
    }

    // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø¨Ø¯Ø¦ÙŠ
    const now = new Date();
    const inOneHour = new Date(now.getTime() + 3600000);
    document.getElementById('startDateTime').value = now.toISOString().slice(0,16);
    document.getElementById('endDateTime').value = inOneHour.toISOString().slice(0,16);
  </script></body>
</html>
